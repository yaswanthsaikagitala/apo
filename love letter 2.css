
* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; }
body {
  background: linear-gradient(180deg,#f7eef2 0%, #ffeef7 100%);
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Dancing Script", cursive;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 24px;
  padding: 36px;
  color: #333;
}

/* envelope wrapper */
.envlope-wrapper { perspective: 1000px; }

/* envelope container */
#envelope {
  width: 380px;
  position: relative;
  transition: transform 600ms ease;
  transform-origin: top center;
}

/* common front parts */
.front {
  position: absolute;
  left: 0;
  right: 0;
  margin: 0 auto;
  width: 100%;
  height: 220px;
  background: linear-gradient(180deg,#fff 0%, #f8f0ff 100%);
  border-radius: 6px;
  box-shadow: 0 10px 30px rgba(60,10,40,0.12);
  backface-visibility: hidden;
}

/* top flap */
.front.flap {
  height: 120px;
  top: -30px;
  border-bottom-left-radius: 200px 60px;
  border-bottom-right-radius: 200px 60px;
  transform-origin: top center;
  z-index: 6; /* flap above paper while closed */
  transition: transform 800ms cubic-bezier(.2,.9,.2,1);
  pointer-events: none;
}

/* pocket that holds the letter */
.front.pocket {
  top: 40px;
  z-index: 1;
  position: relative;       /* contain the letter */
  overflow: hidden;         /* clip the paper while closed */
  padding: 56px 24px 24px;  /* big top padding so first lines clear the flap */
  display: flex;
  align-items: flex-start;
  justify-content: center;
}

/* letter inside pocket */
.letter {
  width: 320px;
  background: linear-gradient(180deg,#fff 0%, #fffefc 100%);
  border-radius: 6px;
  padding: 36px 16px 20px;    /* push content down so header isn't hidden */
  box-shadow: 0 6px 20px rgba(20,10,30,0.06);
  transform: translateY(28px); /* closed baseline */
  transition: transform 600ms cubic-bezier(.2,.9,.2,1), box-shadow 300ms;
  position: relative;
  z-index: 2;                  /* below flap while closed */
  display: flex;
  flex-direction: column;
  gap: 10px;
  max-height: 320px;
  overflow-y: auto;            /* internal scroll if content is long */
  -webkit-overflow-scrolling: touch;
}

/* handwriting style lines */
.words {
  display: block;
  font-family: "Dancing Script", cursive;
  font-size: 18px;
  line-height: 1.6;
  color: #2b2130;
  opacity: 0;
  transform: translateY(8px);
  transition: opacity 300ms ease, transform 300ms ease;
  word-break: break-word;
  white-space: pre-wrap;
  padding-right: 6px; /* avoid text under scrollbar */
}

/* reveal lines when JS adds .show */
.words.show { opacity: 1; transform: translateY(0); }

/* fallback: ensure content visible if JS not yet run but envelope opened */
#envelope.open .words { opacity: 1; transform: translateY(0); transition-delay: 0s; }

/* allow pocket to reveal the letter when opened */
#envelope.open .front.pocket { overflow: visible; }

/* open state: lift the letter out of the pocket and above flap */
#envelope.open .letter {
  transform: translateY(-120px);
  z-index: 8; /* above flap when opened */
}

/* flap open transform (keeps flap visually folded back) */
#envelope.open .front.flap {
  transform: rotateX(180deg) translateY(-6px);
  z-index: 4;
}

/* hearts */
.hearts { position: absolute; inset: auto 18px 14px auto; z-index: 0; pointer-events: none; }
.heart {
  width: 14px; height: 14px;
  background: #ff6b9a;
  transform: rotate(-45deg) scale(0);
  border-radius: 3px 3px 0 0;
  position: absolute;
  bottom: 16px;
  opacity: 0;
}
.heart::after, .heart::before {
  content: "";
  width: 14px; height: 14px;
  background: #ff6b9a;
  border-radius: 50%;
  position: absolute;
  top: -7px;
  left: 0;
}
.heart::before { left: 7px; top: 0; }

/* positions for hearts */
.a1 { left: 40px; }
.a2 { left: 80px; }
.a3 { left: 120px; }

/* heart animation trigger */
#envelope.open .heart { animation: pop 900ms ease forwards; }

/* subtle hover for buttons */
.reset { display:flex; gap:10px; justify-content:center; margin-top:12px; }
.reset button {
  padding: 10px 14px;
  border-radius: 8px;
  border: 2px solid rgba(196, 40, 60, 0.18);
  background: #ffd6ea;
  cursor: pointer;
  font-weight: 600;
  transition: transform 160ms ease, box-shadow 160ms ease;
}
.reset button:hover { transform: translateY(-3px); box-shadow: 0 6px 18px rgba(200,40,100,0.12); }

/* custom small scrollbar so long letters look clean */
.letter::-webkit-scrollbar { width: 8px; }
.letter::-webkit-scrollbar-track { background: transparent; }
.letter::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg,#ff9fb7,#ff6b9a);
  border-radius: 6px;
}

/* keyframes */
@keyframes pop {
  0% { transform: translateY(18px) rotate(-45deg) scale(0); opacity: 0; }
  40% { transform: translateY(-6px) rotate(-45deg) scale(1.05); opacity: 1; }
  100% { transform: translateY(-18px) rotate(-45deg) scale(1); opacity: 1; }
}

/* responsive */
@media (max-width:420px) {
  #envelope { width: 320px; }
  .letter { width: 280px; font-size: 16px; max-height: 300px; padding-top: 30px; }
  .words { font-size: 16px; line-height: 1.55; }
}
